{"remainingRequest":"/Users/aleksej/Projects/what2vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/aleksej/Projects/what2vue/src/views/Category/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/aleksej/Projects/what2vue/src/views/Category/index.vue","mtime":1615051598021},{"path":"/Users/aleksej/Projects/what2vue/node_modules/cache-loader/dist/cjs.js","mtime":1610645746854},{"path":"/Users/aleksej/Projects/what2vue/node_modules/babel-loader/lib/index.js","mtime":1610645748948},{"path":"/Users/aleksej/Projects/what2vue/node_modules/cache-loader/dist/cjs.js","mtime":1610645746854},{"path":"/Users/aleksej/Projects/what2vue/node_modules/vue-loader/lib/index.js","mtime":1610645763935}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBhcGkgZnJvbSAnQC9hcGknCmltcG9ydCBNb3ZpZUxpc3QgZnJvbSAnQC9jb21wb25lbnRzL01vdmllTGlzdCcKaW1wb3J0IEludGVyc2VjdGlvbk9ic2VydmVyIGZyb20gJ0AvY29tcG9uZW50cy9JbnRlcnNlY3Rpb25PYnNlcnZlcicKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBNb3ZpZUxpc3QsCiAgICBJbnRlcnNlY3Rpb25PYnNlcnZlciwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwYWdlOiAxLAogICAgICBtb3ZpZXM6IFtdLAogICAgICB0b3RhbDogMCwKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBoYXNNb3ZpZXMoKSB7CiAgICAgIGlmICghdGhpcy5tb3ZpZXMpIHJldHVybgogICAgICByZXR1cm4gdGhpcy5tb3ZpZXMubGVuZ3RoID4gMAogICAgfSwKICAgIG5hbWUoKSB7CiAgICAgIGNvbnN0IGNhdGVnb3kgPSBhcGkuY2F0ZWdvcnkuc2hvdyh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpCiAgICAgIHJldHVybiBjYXRlZ295Lm5hbWUKICAgIH0sCiAgICBxdWVyeSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBwYWdlOiB0aGlzLnBhZ2UsCiAgICAgIH0KICAgIH0sCiAgfSwKICB3YXRjaDogewogICAgYXN5bmMgJ3F1ZXJ5LnBhZ2UnKG5leHQsIHByZXYpIHsKICAgICAgaWYgKG5leHQgPiBwcmV2KSB7CiAgICAgICAgdGhpcy5xdWVyeS5wYWdlID0gbmV4dAogICAgICAgIHRoaXMudXBkYXRlUXVlcnkodGhpcy5xdWVyeSkKICAgICAgICB0aGlzLm1vdmllcyA9IHRoaXMubW92aWVzLmNvbmNhdChhd2FpdCB0aGlzLmdldENhdGVnb3J5KCkpCiAgICAgIH0KICAgIH0sCiAgICBhc3luYyAnJHJvdXRlLnBhcmFtcy5pZCcobmV4dCwgcHJldikgewogICAgICBpZiAobmV4dCAhPT0gcHJldikgewogICAgICAgIHRoaXMubW92aWVzID0gW10KICAgICAgICB0aGlzLnBhZ2UgPSAxCiAgICAgICAgdGhpcy51cGRhdGVRdWVyeSh0aGlzLnF1ZXJ5KQogICAgICAgIHRoaXMubW92aWVzID0gdGhpcy5tb3ZpZXMuY29uY2F0KGF3YWl0IHRoaXMuZ2V0Q2F0ZWdvcnkoKSkKICAgICAgfQogICAgfSwKICB9LAogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICB0aGlzLm1vdmllcyA9IGF3YWl0IHRoaXMuZ2V0Q2F0ZWdvcnkoKQogIH0sCiAgZGVzdHJveWVkKCkgewogICAgdGhpcy5tb3ZpZXMgPSBbXQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0Q2F0ZWdvcnkoKSB7CiAgICAgIGNvbnN0IHF1ZXJ5ID0gdGhpcy5xdWVyeQogICAgICBjb25zdCBpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZAogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5tb3ZpZUNhdGVnb3J5LnNob3coaWQsIHsgcXVlcnkgfSkKICAgICAgY29uc3QgeyB0b3RhbF9yZXN1bHRzID0gMCwgcmVzdWx0cyA9IFtdIH0gPSByZXNwb25zZQogICAgICB0aGlzLnRvdGFsID0gdG90YWxfcmVzdWx0cwogICAgICByZXR1cm4gcmVzdWx0cwogICAgfSwKICAgIHVwZGF0ZVF1ZXJ5KHF1ZXJ5KSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcXVlcnkgfSkKICAgIH0sCiAgICBuZXh0UGFnZSgpIHsKICAgICAgdGhpcy5wYWdlKysKICAgIH0sCiAgfSwKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Category","sourcesContent":["<template>\n  <section class=\"max-w-7xl mx-auto sm:px-6 lg:px-8 grid gap-4\">\n    <header class=\"flex justify-between\">\n      <h2 class=\"uppercase font-bold\">{{ name }} â€¢ {{ total }}</h2>\n    </header>\n    <div v-if=\"hasMovies\">\n      <MovieList :list=\"movies\" />\n      <IntersectionObserver\n        :options=\"{ rootMargin: '300px' }\"\n        @intersect=\"nextPage\"\n      />\n    </div>\n  </section>\n</template>\n\n<script>\nimport api from '@/api'\nimport MovieList from '@/components/MovieList'\nimport IntersectionObserver from '@/components/IntersectionObserver'\n\nexport default {\n  components: {\n    MovieList,\n    IntersectionObserver,\n  },\n  data() {\n    return {\n      page: 1,\n      movies: [],\n      total: 0,\n    }\n  },\n  computed: {\n    hasMovies() {\n      if (!this.movies) return\n      return this.movies.length > 0\n    },\n    name() {\n      const categoy = api.category.show(this.$route.params.id)\n      return categoy.name\n    },\n    query() {\n      return {\n        page: this.page,\n      }\n    },\n  },\n  watch: {\n    async 'query.page'(next, prev) {\n      if (next > prev) {\n        this.query.page = next\n        this.updateQuery(this.query)\n        this.movies = this.movies.concat(await this.getCategory())\n      }\n    },\n    async '$route.params.id'(next, prev) {\n      if (next !== prev) {\n        this.movies = []\n        this.page = 1\n        this.updateQuery(this.query)\n        this.movies = this.movies.concat(await this.getCategory())\n      }\n    },\n  },\n  async mounted() {\n    this.movies = await this.getCategory()\n  },\n  destroyed() {\n    this.movies = []\n  },\n  methods: {\n    async getCategory() {\n      const query = this.query\n      const id = this.$route.params.id\n      const response = await api.movieCategory.show(id, { query })\n      const { total_results = 0, results = [] } = response\n      this.total = total_results\n      return results\n    },\n    updateQuery(query) {\n      this.$router.push({ query })\n    },\n    nextPage() {\n      this.page++\n    },\n  },\n}\n</script>\n"]}]}