{"remainingRequest":"/Users/aleksej/Projects/what2vue/node_modules/babel-loader/lib/index.js!/Users/aleksej/Projects/what2vue/node_modules/eslint-loader/index.js??ref--13-0!/Users/aleksej/Projects/what2vue/src/plugins/vuex/modules/auth.js","dependencies":[{"path":"/Users/aleksej/Projects/what2vue/src/plugins/vuex/modules/auth.js","mtime":1614845987301},{"path":"/Users/aleksej/Projects/what2vue/node_modules/cache-loader/dist/cjs.js","mtime":1610645746854},{"path":"/Users/aleksej/Projects/what2vue/node_modules/babel-loader/lib/index.js","mtime":1610645748948},{"path":"/Users/aleksej/Projects/what2vue/node_modules/eslint-loader/index.js","mtime":1610645760248}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL2FsZWtzZWovUHJvamVjdHMvd2hhdDJ2dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL2FsZWtzZWovUHJvamVjdHMvd2hhdDJ2dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7Ci8vIGltcG9ydCBheGlvcyBmcm9tICdheGlvcycKaW1wb3J0IGFwaSBmcm9tICdAL2FwaS9pbmRleCc7CmltcG9ydCB2NCBmcm9tICdAL2FwaS9jb25maWcudjQuanMnOwppbXBvcnQgdjMgZnJvbSAnQC9hcGkvY29uZmlnLnYzLmpzJzsKdmFyIHN0YXRlID0gewogIHVzZXI6IG51bGwsCiAgcmVxdWVzdF90b2tlbjogbnVsbCwKICBhY2Nlc3NfdG9rZW46IG51bGwKfTsKdmFyIGdldHRlcnMgPSB7CiAgaXNMb2dnZWRJbjogZnVuY3Rpb24gaXNMb2dnZWRJbihzdGF0ZSkgewogICAgcmV0dXJuICEhc3RhdGUudXNlcjsKICB9LAogIGlzTG9nZ2VkT3V0OiBmdW5jdGlvbiBpc0xvZ2dlZE91dChzdGF0ZSkgewogICAgcmV0dXJuICFzdGF0ZS51c2VyOwogIH0sCiAgdXNlcjogZnVuY3Rpb24gdXNlcihzdGF0ZSkgewogICAgcmV0dXJuIHN0YXRlLnVzZXI7CiAgfSwKICByZXF1ZXN0X3Rva2VuOiBmdW5jdGlvbiByZXF1ZXN0X3Rva2VuKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUucmVxdWVzdF90b2tlbjsKICB9LAogIGFjY2Vzc190b2tlbjogZnVuY3Rpb24gYWNjZXNzX3Rva2VuKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUuYWNjZXNzX3Rva2VuOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKF9yZWYpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBjb21taXQsIHJlc3BvbnNlOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGFwaS5yZXF1ZXN0VG9rZW4uY3JlYXRlKHsKICAgICAgICAgICAgICAgIHJlZGlyZWN0X3RvOiAiIi5jb25jYXQobG9jYXRpb24ucHJvdG9jb2wsICIvIikuY29uY2F0KGxvY2F0aW9uLmhvc3QpCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3VjY2VzcykgewogICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oImh0dHBzOi8vd3d3LnRoZW1vdmllZGIub3JnL2F1dGgvYWNjZXNzP3JlcXVlc3RfdG9rZW49Ii5jb25jYXQocmVzcG9uc2UucmVxdWVzdF90b2tlbiksICdfc2VsZicpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29tbWl0KCdzdG9yZV9yZXF1ZXN0X3Rva2VuJywgcmVzcG9uc2UucmVxdWVzdF90b2tlbik7CgogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKCk7CiAgfSwKICBnZXRBY2Nlc3NUb2tlbjogZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oY29udGV4dCkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgIHZhciByZXNwb25zZTsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIGFwaS5hY2Nlc3NUb2tlbi5jcmVhdGUoewogICAgICAgICAgICAgICAgcmVxdWVzdF90b2tlbjogY29udGV4dC5zdGF0ZS5yZXF1ZXN0X3Rva2VuCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmFjY2Vzc190b2tlbikgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgdjQuZGVmYXVsdHMuaGVhZGVycy5jb21tb24gPSB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KHJlc3BvbnNlLmFjY2Vzc190b2tlbikKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGNvbnRleHQuY29tbWl0KCdzdG9yZV9hY2Nlc3NfdG9rZW4nLCByZXNwb25zZS5hY2Nlc3NfdG9rZW4pOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTIpOwogICAgfSkpKCk7CiAgfSwKICBsb2FkUHJvZmlsZTogZnVuY3Rpb24gbG9hZFByb2ZpbGUoY29udGV4dCkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgIHZhciByZXNwb25zZTsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIGFwaS5hY2NvdW50LnNob3coKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgIGNvbnRleHQuY29tbWl0KCdzdG9yZV91c2VyJywgcmVzcG9uc2UpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTMpOwogICAgfSkpKCk7CiAgfSwKICBjcmVhdGVTZXNzaW9uRm9yVjM6IGZ1bmN0aW9uIGNyZWF0ZVNlc3Npb25Gb3JWMyhjb250ZXh0KSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgdmFyIHJlc3BvbnNlOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gYXBpLnNlc3Npb24uY3JlYXRlKHsKICAgICAgICAgICAgICAgIGFjY2Vzc190b2tlbjogY29udGV4dC5zdGF0ZS5hY2Nlc3NfdG9rZW4KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgIHYzLmRlZmF1bHRzLnBhcmFtcyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdjMuZGVmYXVsdHMucGFyYW1zKSwge30sIHsKICAgICAgICAgICAgICAgIHNlc3Npb25faWQ6IHJlc3BvbnNlLnNlc3Npb25faWQKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU0KTsKICAgIH0pKSgpOwogIH0sCiAgZ2V0UHJvZmlsZTogZnVuY3Rpb24gZ2V0UHJvZmlsZShjb250ZXh0KSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBpZiAoIWNvbnRleHQuc3RhdGUucmVxdWVzdF90b2tlbikgewogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goJ2dldEFjY2Vzc1Rva2VuJyk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA1OwogICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BhdGNoKCdjcmVhdGVTZXNzaW9uRm9yVjMnKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goJ2xvYWRQcm9maWxlJyk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNSk7CiAgICB9KSkoKTsKICB9LAogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KGNvbnRleHQpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICB2YXIgcmVzcG9uc2U7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBhcGkuYWNjZXNzVG9rZW4uZGVzdHJveSh7CiAgICAgICAgICAgICAgICBhY2Nlc3NfdG9rZW46IGNvbnRleHQuc3RhdGUuYWNjZXNzX3Rva2VuCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgICAgICAgY29udGV4dC5jb21taXQoJ2xvZ291dCcpOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTYpOwogICAgfSkpKCk7CiAgfQp9Owp2YXIgbXV0YXRpb25zID0gewogIHN0b3JlX3JlcXVlc3RfdG9rZW46IGZ1bmN0aW9uIHN0b3JlX3JlcXVlc3RfdG9rZW4oc3RhdGUsIHRva2VuKSB7CiAgICBzdGF0ZS5yZXF1ZXN0X3Rva2VuID0gdG9rZW47CiAgfSwKICBzdG9yZV9hY2Nlc3NfdG9rZW46IGZ1bmN0aW9uIHN0b3JlX2FjY2Vzc190b2tlbihzdGF0ZSwgdG9rZW4pIHsKICAgIHN0YXRlLmFjY2Vzc190b2tlbiA9IHRva2VuOwogIH0sCiAgc3RvcmVfdXNlcjogZnVuY3Rpb24gc3RvcmVfdXNlcihzdGF0ZSwgdXNlcikgewogICAgc3RhdGUudXNlciA9IHVzZXI7CiAgfSwKICBsb2dvdXQ6IGZ1bmN0aW9uIGxvZ291dChzdGF0ZSkgewogICAgc3RhdGUudXNlciA9IG51bGw7CiAgICBzdGF0ZS5yZXF1ZXN0X3Rva2VuID0gbnVsbDsKICAgIHN0YXRlLmFjY2Vzc190b2tlbiA9IG51bGw7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgc3RhdGU6IHN0YXRlLAogIGdldHRlcnM6IGdldHRlcnMsCiAgYWN0aW9uczogYWN0aW9ucywKICBtdXRhdGlvbnM6IG11dGF0aW9ucwp9Ow=="},{"version":3,"sources":["/Users/aleksej/Projects/what2vue/src/plugins/vuex/modules/auth.js"],"names":["api","v4","v3","state","user","request_token","access_token","getters","isLoggedIn","isLoggedOut","actions","login","commit","requestToken","create","redirect_to","location","protocol","host","response","success","window","open","getAccessToken","context","accessToken","defaults","headers","common","Authorization","loadProfile","account","show","createSessionForV3","session","params","session_id","getProfile","dispatch","logout","destroy","console","log","mutations","store_request_token","token","store_access_token","store_user"],"mappings":"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","sourcesContent":["// import axios from 'axios'\nimport api from '@/api/index'\nimport v4 from '@/api/config.v4.js'\nimport v3 from '@/api/config.v3.js'\n\nconst state = {\n  user: null,\n  request_token: null,\n  access_token: null,\n}\n\nconst getters = {\n  isLoggedIn: (state) => !!state.user,\n  isLoggedOut: (state) => !state.user,\n  user: (state) => state.user,\n  request_token: (state) => state.request_token,\n  access_token: (state) => state.access_token,\n}\n\nconst actions = {\n  async login({ commit }) {\n    const response = await api.requestToken.create({\n      redirect_to: `${location.protocol}/${location.host}`,\n    })\n\n    if (response.success) {\n      window.open(\n        `https://www.themoviedb.org/auth/access?request_token=${response.request_token}`,\n        '_self'\n      )\n    }\n    commit('store_request_token', response.request_token)\n  },\n  async getAccessToken(context) {\n    const response = await api.accessToken.create({\n      request_token: context.state.request_token,\n    })\n\n    if (!response.access_token) return\n\n    v4.defaults.headers.common = {\n      Authorization: `Bearer ${response.access_token}`,\n    }\n\n    context.commit('store_access_token', response.access_token)\n  },\n  async loadProfile(context) {\n    const response = await api.account.show()\n    context.commit('store_user', response)\n  },\n\n  async createSessionForV3(context) {\n    const response = await api.session.create({\n      access_token: context.state.access_token,\n    })\n\n    v3.defaults.params = {\n      ...v3.defaults.params,\n      session_id: response.session_id,\n    }\n  },\n\n  async getProfile(context) {\n    if (context.state.request_token) {\n      await context.dispatch('getAccessToken')\n      await context.dispatch('createSessionForV3')\n      await context.dispatch('loadProfile')\n    }\n  },\n\n  async logout(context) {\n    const response = await api.accessToken.destroy({\n      access_token: context.state.access_token,\n    })\n    console.log(response)\n    context.commit('logout')\n  },\n}\nconst mutations = {\n  store_request_token: (state, token) => {\n    state.request_token = token\n  },\n  store_access_token: (state, token) => {\n    state.access_token = token\n  },\n  store_user: (state, user) => {\n    state.user = user\n  },\n  logout: (state) => {\n    state.user = null\n    state.request_token = null\n    state.access_token = null\n  },\n}\n\nexport default {\n  state,\n  getters,\n  actions,\n  mutations,\n}\n"]}]}