{"remainingRequest":"/Users/aleksej/Projects/what2vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/aleksej/Projects/what2vue/src/components/renderless/Fetch.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/aleksej/Projects/what2vue/src/components/renderless/Fetch.vue","mtime":1615058374534},{"path":"/Users/aleksej/Projects/what2vue/node_modules/cache-loader/dist/cjs.js","mtime":1610645746854},{"path":"/Users/aleksej/Projects/what2vue/node_modules/babel-loader/lib/index.js","mtime":1610645748948},{"path":"/Users/aleksej/Projects/what2vue/node_modules/cache-loader/dist/cjs.js","mtime":1610645746854},{"path":"/Users/aleksej/Projects/what2vue/node_modules/vue-loader/lib/index.js","mtime":1610645763935}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG9uTW91bnRlZCwgcmVmIH0gZnJvbSAnQHZ1ZS9jb21wb3NpdGlvbi1hcGknCgpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIGFwaWNhbGw6IHsKICAgICAgdHlwZTogUHJvbWlzZSwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAogIH0sCiAgc2V0dXAoeyBhcGljYWxsIH0pIHsKICAgIGNvbnN0IGRhdGEgPSByZWYoKQogICAgY29uc3QgZXJyb3IgPSByZWYoKQogICAgY29uc3Qgc3RhdGUgPSByZWYoJ2lkbGUnKQoKICAgIGNvbnN0IHN0YXRlcyA9IHsKICAgICAgaWRsZTogJ2lkbGUnLAogICAgICBsb2FkaW5nOiAnbG9hZGluZycsCiAgICAgIHN1Y2Nlc3M6ICdzdWNjZXNzJywKICAgICAgZXJyb3I6ICdlcnJvcicsCiAgICB9CgogICAgY29uc3QgbG9hZCA9ICgpID0+IHsKICAgICAgc3RhdGUudmFsdWUgPSBzdGF0ZXMubG9hZGluZwogICAgICBkYXRhLnZhbHVlID0gdW5kZWZpbmVkCiAgICAgIGVycm9yLnZhbHVlID0gdW5kZWZpbmVkCgogICAgICBhcGljYWxsCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhzdGF0ZXMsIHJlc3BvbnNlKQogICAgICAgICAgc3RhdGUudmFsdWUgPSBzdGF0ZXMuc3VjY2VzcwogICAgICAgICAgZGF0YS52YWx1ZSA9IHJlc3BvbnNlCiAgICAgICAgICByZXR1cm4gcmVzcG9uc2UKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIHN0YXRlLnZhbHVlID0gc3RhdGVzLmVycm9yCiAgICAgICAgICBkYXRhLnZhbHVlID0gdW5kZWZpbmVkCiAgICAgICAgICBlcnJvci52YWx1ZSA9IGVycm9yCiAgICAgICAgfSkKICAgIH0KCiAgICBvbk1vdW50ZWQoKCkgPT4gewogICAgICBsb2FkKCkKICAgIH0pCgogICAgcmV0dXJuIHsgZGF0YSwgbG9hZCwgZXJyb3IsIHN0YXRlIH0KICB9LAp9Cg=="},{"version":3,"sources":["Fetch.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAaA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"Fetch.vue","sourceRoot":"src/components/renderless","sourcesContent":["<template>\n  <div>\n    <slot v-if=\"state === 'error'\" name=\"error\" v-bind=\"{ error, load }\">\n      <pre>{{ error }}</pre>\n    </slot>\n    <slot v-if=\"state === 'success'\" name=\"success\" v-bind=\"{ data, load }\">\n      <pre>{{ data }}</pre>\n    </slot>\n    <slot v-if=\"state === 'loading'\" name=\"loading\">loading...</slot>\n  </div>\n</template>\n\n<script>\nimport { onMounted, ref } from '@vue/composition-api'\n\nexport default {\n  props: {\n    apicall: {\n      type: Promise,\n      required: true,\n    },\n  },\n  setup({ apicall }) {\n    const data = ref()\n    const error = ref()\n    const state = ref('idle')\n\n    const states = {\n      idle: 'idle',\n      loading: 'loading',\n      success: 'success',\n      error: 'error',\n    }\n\n    const load = () => {\n      state.value = states.loading\n      data.value = undefined\n      error.value = undefined\n\n      apicall\n        .then((response) => {\n          console.log(states, response)\n          state.value = states.success\n          data.value = response\n          return response\n        })\n        .catch((error) => {\n          state.value = states.error\n          data.value = undefined\n          error.value = error\n        })\n    }\n\n    onMounted(() => {\n      load()\n    })\n\n    return { data, load, error, state }\n  },\n}\n</script>\n"]}]}