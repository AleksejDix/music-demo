{"remainingRequest":"/Users/aleksej/Projects/what2vue/node_modules/babel-loader/lib/index.js!/Users/aleksej/Projects/what2vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/aleksej/Projects/what2vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/aleksej/Projects/what2vue/src/components/renderless/Fetch.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/aleksej/Projects/what2vue/src/components/renderless/Fetch.vue","mtime":1615023296112},{"path":"/Users/aleksej/Projects/what2vue/node_modules/cache-loader/dist/cjs.js","mtime":1610645746854},{"path":"/Users/aleksej/Projects/what2vue/node_modules/babel-loader/lib/index.js","mtime":1610645748948},{"path":"/Users/aleksej/Projects/what2vue/node_modules/cache-loader/dist/cjs.js","mtime":1610645746854},{"path":"/Users/aleksej/Projects/what2vue/node_modules/vue-loader/lib/index.js","mtime":1610645763935}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9hbGVrc2VqL1Byb2plY3RzL3doYXQydnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyByZWYsIG9uTW91bnRlZCB9IGZyb20gJ0B2dWUvY29tcG9zaXRpb24tYXBpJzsKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBhcGljYWxsOiB7CiAgICAgIHR5cGU6IEZ1bmN0aW9uLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQogIH0sCiAgc2V0dXA6IGZ1bmN0aW9uIHNldHVwKF9yZWYpIHsKICAgIHZhciBhcGljYWxsID0gX3JlZi5hcGljYWxsOwogICAgdmFyIGRhdGEgPSByZWYodW5kZWZpbmVkKTsKICAgIHZhciBlcnJvciA9IHJlZih1bmRlZmluZWQpOwogICAgdmFyIHN0YXRlID0gcmVmKCdpZGxlJyk7CiAgICB2YXIgc3RhdGVzID0gewogICAgICBpZGxlOiAnaWRsZScsCiAgICAgIGxvYWRpbmc6ICdsb2FkaW5nJywKICAgICAgc3VjY2VzczogJ3N1Y2Nlc3MnLAogICAgICBlcnJvcjogJ2Vycm9yJwogICAgfTsKCiAgICB2YXIgc2V0RGF0YSA9IGZ1bmN0aW9uIHNldERhdGEoZGF0YSkgewogICAgICBlcnJvci5kYXRhID0gZGF0YTsKICAgIH07CgogICAgdmFyIHNldEVycm9yID0gZnVuY3Rpb24gc2V0RXJyb3IoZXJyb3IpIHsKICAgICAgZXJyb3IudmFsdWUgPSBlcnJvcjsKICAgIH07IC8vIGNvbnN0IGRlc3Ryb3lFcnJvciA9ICgpID0+IHsKICAgIC8vICAgZXJyb3IudmFsdWUgPSB1bmRlZmluZWQKICAgIC8vIH0KCgogICAgdmFyIGxvYWQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIF9kYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGFwaWNhbGwoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX2RhdGEgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coX2RhdGEpOwogICAgICAgICAgICAgICAgc3RhdGUudmFsdWUgPSBzdGF0ZXMuc3VjY2VzczsKICAgICAgICAgICAgICAgIHNldERhdGEoX2RhdGEpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX2RhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDEwOwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgwKTsKICAgICAgICAgICAgICAgIHN0YXRlLnZhbHVlID0gc3RhdGVzLmVycm9yOwogICAgICAgICAgICAgICAgc2V0RXJyb3IoX2NvbnRleHQudDApOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQudDApOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1swLCAxMF1dKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIGxvYWQoKSB7CiAgICAgICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCk7CgogICAgb25Nb3VudGVkKGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5sb2coYXBpY2FsbCgpKTsKICAgICAgbG9hZCgpOwogICAgfSk7CiAgICByZXR1cm4gewogICAgICBkYXRhOiBkYXRhLAogICAgICBsb2FkOiBsb2FkLAogICAgICBlcnJvcjogZXJyb3IsCiAgICAgIHN0YXRlOiBzdGF0ZQogICAgfTsKICB9Cn07"},{"version":3,"sources":["Fetch.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAaA,SAAA,GAAA,EAAA,SAAA,QAAA,sBAAA;AAEA,eAAA;AACA,EAAA,KAAA,EAAA;AACA,IAAA,OAAA,EAAA;AACA,MAAA,IAAA,EAAA,QADA;AAEA,MAAA,QAAA,EAAA;AAFA;AADA,GADA;AAOA,EAAA,KAPA,uBAOA;AAAA,QAAA,OAAA,QAAA,OAAA;AACA,QAAA,IAAA,GAAA,GAAA,CAAA,SAAA,CAAA;AACA,QAAA,KAAA,GAAA,GAAA,CAAA,SAAA,CAAA;AACA,QAAA,KAAA,GAAA,GAAA,CAAA,MAAA,CAAA;AAEA,QAAA,MAAA,GAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA,SAFA;AAGA,MAAA,OAAA,EAAA,SAHA;AAIA,MAAA,KAAA,EAAA;AAJA,KAAA;;AAOA,QAAA,OAAA,GAAA,SAAA,OAAA,CAAA,IAAA,EAAA;AACA,MAAA,KAAA,CAAA,IAAA,GAAA,IAAA;AACA,KAFA;;AAIA,QAAA,QAAA,GAAA,SAAA,QAAA,CAAA,KAAA,EAAA;AACA,MAAA,KAAA,CAAA,KAAA,GAAA,KAAA;AACA,KAFA,CAhBA,CAoBA;AACA;AACA;;;AAEA,QAAA,IAAA;AAAA,0EAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAIA,OAAA,EAJA;;AAAA;AAIA,gBAAA,KAJA;AAKA,gBAAA,OAAA,CAAA,GAAA,CAAA,KAAA;AACA,gBAAA,KAAA,CAAA,KAAA,GAAA,MAAA,CAAA,OAAA;AACA,gBAAA,OAAA,CAAA,KAAA,CAAA;AAPA,iDAQA,KARA;;AAAA;AAAA;AAAA;AAUA,gBAAA,KAAA,CAAA,KAAA,GAAA,MAAA,CAAA,KAAA;AACA,gBAAA,QAAA,aAAA;AAXA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA,sBAAA,IAAA;AAAA;AAAA;AAAA,OAAA;;AAgBA,IAAA,SAAA,CAAA,YAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,OAAA,EAAA;AACA,MAAA,IAAA;AACA,KAHA,CAAA;AAKA,WAAA;AAAA,MAAA,IAAA,EAAA,IAAA;AAAA,MAAA,IAAA,EAAA,IAAA;AAAA,MAAA,KAAA,EAAA,KAAA;AAAA,MAAA,KAAA,EAAA;AAAA,KAAA;AACA;AArDA,CAAA","sourcesContent":["<template>\n  <div>\n    <slot v-if=\"state === 'error'\" name=\"error\" v-bind=\"{ error, load }\">\n      <pre>{{ error }}</pre>\n    </slot>\n    <slot v-if=\"state === 'success'\" name=\"success\" v-bind=\"{ data, load }\">\n      <pre>{{ data }}</pre>\n    </slot>\n    <slot v-if=\"state === 'loading'\" name=\"loading\">loading...</slot>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from '@vue/composition-api'\n\nexport default {\n  props: {\n    apicall: {\n      type: Function,\n      required: true,\n    },\n  },\n  setup({ apicall }) {\n    const data = ref(undefined)\n    const error = ref(undefined)\n    const state = ref('idle')\n\n    const states = {\n      idle: 'idle',\n      loading: 'loading',\n      success: 'success',\n      error: 'error',\n    }\n\n    const setData = (data) => {\n      error.data = data\n    }\n\n    const setError = (error) => {\n      error.value = error\n    }\n\n    // const destroyError = () => {\n    //   error.value = undefined\n    // }\n\n    const load = async () => {\n      // state.value = states.loading\n      // destroyError()\n      try {\n        const data = await apicall()\n        console.log(data)\n        state.value = states.success\n        setData(data)\n        return data\n      } catch (error) {\n        state.value = states.error\n        setError(error)\n        return error\n      }\n    }\n\n    onMounted(() => {\n      console.log(apicall())\n      load()\n    })\n\n    return { data, load, error, state }\n  },\n}\n</script>\n"],"sourceRoot":"src/components/renderless"}]}